services:
  nag:
    # Remove the 'build' section if you want to use a pre-built image from ghcr.io
    build: .
    image: ghcr.io/flyinpancake/nag:latest
    ports:
      - "3000:3000"
    volumes:
      - nag_data:/app/data
    environment:
      JSON_LOGS: false # Set to true to enable JSON logging (default: false)

      # Authentication settings
      AUTH_ENABLED: true # Set to false to disable authentication (default: false)
      # If AUTH_ENABLED is true, you must set the following environment variables:
      OIDC_ISSUER_URL: https://auth.example.com
      OIDC_CLIENT_ID: nag-dev-id
      OIDC_CLIENT_SECRET: nag-dev-secret
      OIDC_REDIRECT_URL: https://nag.example.com/auth/callback

      # Notifications
      NOTIFICATIONS_ENABLED: true # Set to true to enable notifications (default: false)
      # If NOTIFICATIONS_ENABLED is true, you must set the following environment variables:
      TELEGRAM_BOT_TOKEN: your-telegram-bot-token
      TELEGRAM_CHAT_ID: your-telegram-chat-id
      # Optional notification settings
      # If not set, defaults will be used:
      NOTIFICATION_POLL_INTERVAL_SECONDS: 60
      NOTIFICATION_DISPATCH_INTERVAL_SECONDS: 15
      NOTIFICATION_MAX_ATTEMPTS: 5
      NOTIFICATION_BATCH_SIZE: 50

volumes:
  nag_data:
